////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
// SPELL: Allow ressurection use on TAC_DYING characters
//
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////



new entry "Teleportation_Resurrection"
type "SpellData"
using "Teleportation_Resurrection"
data "OriginTargetConditions" "not Tagged('BLOCK_RESURRECTION') and not Self() and not Item() and (Dead() or IsDowned() or HasStatus('PETRIFIED') or Tagged('ALLOW_RESURRECTION')) and Tagged('PLAYABLE')"



////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// 
// BOOST: These are used to simulate the downed state
//
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////



new entry "TAC_DOWNED"
type "StatusData"
using "DOWNED"
data "StatusType" "INCAPACITATED"
data "AnimationStart" ""
data "OnRollsFailed" ""
data "StatusGroups" "SG_Unconscious;SG_Incapacitated;SG_Helpable_Condition"
data "RemoveEvents" "OnHeal"
data "OnRollsFailed" "ApplyStatus(TAC_DYING,100,-1,DoT)"

new entry "TAC_DYING"
type "StatusData"
using "LIE_DYING"
data "Boosts" "BlockRegainHP();Invulnerable();Tag(AI_IGNORED_TARGET);Tag(ALLOW_RESURRECTION)"
data "StatusGroups" "SG_Unconscious;SG_Incapacitated;SG_Condition"
data "StatusPropertyFlags" "AllowLeaveCombat;DisableCombatlog;DisableOverhead;IgnoreResting"
data "RemoveEvents" "OnHeal;OnStatusApplied"
data "RemoveConditions" "HasStatus('RESURRECTING')"
data "OnRemoveFunctors" "ResetCombatTurn()"

new entry "BLOCK_ATTACKS"
type "StatusData"
data "StatusType" "BOOST"
data "DisplayName" "BLOCK_ATTACKS;1"
data "Description" "BLOCK_ATTACKS_Des;2
data "StackId" "BLOCK_ATTACKS"
data "RemoveConditions" "not HasStatus('BLOCK_ATTACKS_1') and not HasStatus('BLOCK_ATTACKS_2') and not HasStatus('BLOCK_ATTACKS_3')"
data "RemoveEvents" "OnAttacked;OnTurn"
data "StatusPropertyFlags" "DisableCombatlog;DisableOverhead;DisablePortraitIndicator;ExcludeFromPortraitRendering"
data "OnApplyFunctors" "ApplyStatus(BLOCK_ATTACKS_3, -1, -1);ApplyStatus(BLOCK_ATTACKS_2, -1, -1);ApplyStatus(BLOCK_ATTACKS_1, -1, -1);"
data "OnRemoveFunctors" "RemoveStatus(BLOCK_ATTACKS_1);RemoveStatus(BLOCK_ATTACKS_2);RemoveStatus(BLOCK_ATTACKS_3);"

new entry "BLOCK_ATTACKS_1"
type "StatusData"
data "StatusType" "BOOST"
data "DisplayName" "BLOCK_ATTACKS;1"
data "Description" "BLOCK_ATTACKS_Des;2
data "Icon" "TAC_BlockAttacks"
data "StackId" "BLOCK_ATTACKS_1"
data "Boosts" "DamageReduction(All, Flat, 1000)"
data "RemoveConditions" "(HasDamageEffectFlag(DamageFlags.Hit) or HasDamageEffectFlag(DamageFlags.Critical)) and not (IsMiss() or IsCriticalMiss())"
data "RemoveEvents" "OnAttacked"
data "StatusPropertyFlags" "DisableCombatlog;DisableOverhead"

new entry "BLOCK_ATTACKS_2"
type "StatusData"
data "StatusType" "BOOST"
using "BLOCK_ATTACKS_1"
data "StackId" "BLOCK_ATTACKS_2"
data "RemoveConditions" "(HasDamageEffectFlag(DamageFlags.Hit) or HasDamageEffectFlag(DamageFlags.Critical)) and not (IsMiss() or IsCriticalMiss()) and not HasStatus('BLOCK_ATTACKS_1')"

new entry "BLOCK_ATTACKS_3"
type "StatusData"
data "StatusType" "BOOST"
using "BLOCK_ATTACKS_1"
data "StackId" "BLOCK_ATTACKS_3"
data "RemoveConditions" "(HasDamageEffectFlag(DamageFlags.Hit) or HasDamageEffectFlag(DamageFlags.Critical)) and not (IsMiss() or IsCriticalMiss()) and not HasStatus('BLOCK_ATTACKS_2')"
data "OnRemoveFunctors" "RemoveStatus(BLOCK_ATTACKS)"
